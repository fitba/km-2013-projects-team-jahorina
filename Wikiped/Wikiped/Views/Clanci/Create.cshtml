@model List<Wikiped.DBBL.DAL.TagVrste>
@using Wikiped.DBBL.DAL;
@{
    ViewBag.Title = "Create";
    Layout = "~/Views/Shared/Pocetna.cshtml";
}


<script src="/Script/tiny_mce/tiny_mce.js" type="text/javascript"></script>
<script src="../../Script/clanci.js" type="text/javascript"></script>
<link href="/Script/autocomplete/css/jquery.tagit.clanak.css" rel="stylesheet" type="text/css" />
<script src="/Script/autocomplete/tag-it.js" type="text/javascript"></script>
<script src="/Script/autocomplete/autocomplete-tags.js" type="text/javascript"></script>
<link href="../../Script/chosen/chosen.css" rel="stylesheet" type="text/css" />
<script src="../../Script/chosen/chosen.jquery.js" type="text/javascript"></script>

<div class="clanci-create-head">
<div id="btnNoviClanak" class="clanak-create-meni">Novi clanak</div>
<div id="btnMojiClanci" class="clanak-create-meni">Moji clanci</div>
</div>


<div class="clanak-details-preporuka"></div>
@using (Html.BeginForm("create","Clanci",FormMethod.Post,new {enctype = "multipart/form-data" }))

{
<div class="clanak-details-content">
<div id="mojClanakSkriven" class="clanak-skriveno">
    <div class="clanci-head">Vasi clanci</div>
    <select name="mojClanak" id="mojClanak" class="clanak-create-textBox">
    <option value="0"></option> 
         @foreach (var cls in ViewBag.clanci)
    {
        <option value="@cls.ClanakID">@cls.Naslov</option>
    }
    </select>
    </div>
<div id="NaslovKreiraj" class="clanak-otkriveno">
<div class="clanci-head">
<div class="clanak-head-texts">Naslov</div>

<div id="greskaNaslov" class="clanak-naslovi-greska"></div>

</div>
<input id="txtNaslov" name="naslov" type="text" class="clanak-create-textBox" />
</div>

<div class="clanak-otkriveno">
<div class="clanci-head">Kategorija</div>

    <select name="kategorija" id="ddlkategorije" class="clanak-create-textBox">
    <option value="0"></option> 
    @foreach (var tg in Model)
    {
        <option value="@tg.TagVrstaID">@tg.Opis</option>
    }
        
    </select>
    </div>


    <div class="clanak-skriveno">
    <div id="slKat"class="clanci-head"></div>
    <select name="slicnaKat" id="ddlSlkategorije" class="clanak-create-textBox">
    <option value="0"></option> 
         @foreach (var tg in Model)
    {
        <option value="@tg.TagVrstaID">@tg.Opis</option>
    }
    </select>
</div>
  <div class="clanci-head">
           <div class="clanak-head-texts">Vaš tekst</div> 
            <div id="greskaText" class="clanak-naslovi-greska"></div>
            </div>
        <div class="wmd-panel">
            <textarea name="tekst" class="myTextEditor" style="width: 400px" id="wmd-input">

                    </textarea>
        </div>

<div class="clanci-head">Slika</div>
<input name="slika" type="file" class="clanak-create-textBox" name="fuSlika" />

<div class="clanci-head">Tagovi</div>
<input name="tagovi" type="text" class="clanak-create-textBox" id="txtTagsClanci" name="tags"/>
<input id="update" name="update" type="hidden" value="false"/>
<input id="novaKat" name="novaKat" type="hidden" value=""/>

<input id="btnObjava" class="mainCommentBtn" type="submit" value="Objavi clanak"  />

</div>
}

<h2>Create</h2>

<div>
    @Html.ActionLink("Back to List", "Index")
</div>

<script type="text/javascript">
    $("document").ready(function () {

        $("#mojClanak").change(function () {
            alert($("#mojClanak").val());
        });

        $("#btnMojiClanci").click(function () {


            $("#mojClanakSkriven").slideDown();
            $("#update").val(true);


        });
        $("#btnNoviClanak").click(function () {


            $("#mojClanakSkriven").slideUp();
            $("#update").val(false);


        });

        $("form").submit(function () {
            if (provjeraUnosa() == false) {
                $(".clanak-naslovi-greska").fadeIn();
            }

            return provjeraUnosa();
        });

        $("#ddlkategorije").chosen({ no_results_text: "Kategorija ne postoji" + '<div id="btnNovaKat" class="clanak-nova-kategorija">Dodaj kategoriju</div>' });
        $("#ddlSlkategorije").chosen({ no_results_text: "Trenutno odabrana kategorija: Ostalo - " });
        $("#mojClanak").chosen({ no_results_text: "Trenutno nema clanka - " });
        function provjeraUnosa() {
            var tekst = tinyMCE.activeEditor.getContent();
            if (tekst.length > 50) {
                $("#greskaText").text("");
                if ($("#txtNaslov").val().length > 10) {
                    return true;
                }
                else {

                    $("#greskaNaslov").text("* Unesite 10 ili vise slova!");
                    return false;
                }

            }
            else {

                $("#greskaText").text("* Unesite 50 ili vise slova!");
                if ($("#txtNaslov").val().length < 10) {
                    $("#greskaNaslov").text("* Unesite 10 ili vise slova!");
                } else {

                    $("#greskaNaslov").text("");

                }

                return false;


            }

        }
        $("#btnNovaKat").live('click', function () {
            provjeraUnosa();
            var novaKategorija = $(".no-results").find("span").text();
            $("#novaKat").val(novaKategorija);

            $(".clanak-otkriveno").hide();
            $("#slKat").text("Odaberite slicnu kategoriju za " + novaKategorija + " - ").append("<div class='clanci-change'>Promjeni</div>");
            $(".clanak-skriveno").show();


        });
        $(".clanci-change").live('click', function () {
            $(".clanak-skriveno").hide();
            $(".clanak-otkriveno").show();
        });

        tinyMCE.init({
            // General options
            //mode: "textareas",
            mode: "specific_textareas",
            title: 'Make h1',
            width: "599px",
            editor_selector: "myTextEditor",
            theme: "advanced",
            plugins: "autolink,lists,spellchecker,pagebreak,style,layer,table,save,advhr,advimage,advlink,emotions,iespell,inlinepopups,insertdatetime,preview,media,searchreplace,print,contextmenu,paste,directionality,fullscreen,noneditable,visualchars,nonbreaking,xhtmlxtras,template",
            // Theme options
            theme_advanced_buttons1: "bold,italic,underline,strikethrough,|,justifyleft,justifycenter,justifyright,justifyfull,|formatselect,fontselect,fontsizeselect,|,undo,redo,|,forecolor,backcolor,|,emotions,fullscreen",

            //theme_advanced_buttons4: "insertlayer,moveforward,movebackward,absolute,|,styleprops,spellchecker,|,cite,abbr,acronym,del,ins,attribs,|,visualchars,nonbreaking,template,blockquote,pagebreak,|,insertfile,insertimage",
            theme_advanced_toolbar_location: "top",
            theme_advanced_toolbar_align: "left",
            theme_advanced_statusbar_location: "bottom",
            theme_advanced_resizing: false,
            // Skin options
            skin: "o2k7",
            //skin_variant: "silver", black

            // Example content CSS (should be your site CSS)
            //content_css: "css/example.css",

            // Drop lists for link/image/media/template dialogs
            //        template_external_list_url: "js/template_list.js",
            //        external_link_list_url: "js/link_list.js",
            //        external_image_list_url: "js/image_list.js",
            //        media_external_list_url: "js/media_list.js",

            // Replace values for the template plugin
            template_replace_values: {
                username: "Some User",
                staffid: "991234"
            }
        });
    });

</script>